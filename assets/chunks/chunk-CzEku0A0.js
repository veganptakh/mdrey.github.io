import{r as d,j as c,R as L}from"./chunk-BDiHQZ9Y.js";const E=d.forwardRef((e,n)=>c.jsx("div",{...e,ref:n,style:{display:e.children?"contents":"block"}}));E.displayName="Slot";const S=d.forwardRef((e,n)=>c.jsx("div",{...e,ref:n,style:{display:"contents"}}));S.displayName="Fragment";function b(...e){return e.length===1&&e[0]?e[0]:n=>{for(let t of e)typeof t=="function"?t(n):t!=null&&(t.current=n)}}const g=()=>document.readyState==="complete"||document.readyState==="interactive",l=[];let m=!1;const M=()=>{if(g()===!1){console.error("DOMContentLoaded event has not been fired yet");return}if(m)return;m=!0;const e=document.addEventListener,n=window.addEventListener,t=new Event("DOMContentLoaded"),r=new Event("load");window.addEventListener=(s,i,o)=>{s==="DOMContentLoaded"?l.push(()=>i.call(window,t)):(s==="load"&&l.push(()=>i.call(window,r)),n.call(window,s,i,o))},document.addEventListener=(s,i,o)=>{s==="DOMContentLoaded"?l.push(()=>i.call(document,t)):e.call(document,s,i,o)}},O=()=>{for(const e of l)e();l.length=0},C={scriptTestIdPrefix:"client-"},$=e=>new Promise((n,t)=>{const r=document.createElement("script"),s=e.hasAttribute("src"),i=e.type==="module";for(const{name:o,value:a}of e.attributes)r.setAttribute(o,a);if(r.dataset.testid!==void 0&&(r.dataset.testid=`${C.scriptTestIdPrefix}${r.dataset.testid}`),s)r.addEventListener("load",()=>{n()}),r.addEventListener("error",t);else{if(i){const o=new Blob([e.innerText],{type:"text/javascript"}),a=URL.createObjectURL(o);import(a).then(n).catch(t).finally(()=>{URL.revokeObjectURL(a)});return}r.textContent=e.innerText}e.replaceWith(r),s===!1&&n()}),u=[];let p=!1;const T=async e=>{if(u.push(...e),await Promise.resolve(),!p){for(M(),p=!0;u.length>0;)await u.shift()();O(),p=!1}},A=e=>{const n=e.querySelectorAll("script"),t=[],r=[];n.forEach(s=>{(s.hasAttribute("async")?r:t).push(()=>$(s))});for(const s of r)s();T(t)},H=e=>{const{code:n,innerRef:t,...r}=e;return c.jsx("div",{ref:t,...r,style:{display:"block",padding:20},children:'Open the "Settings" panel to insert HTML code.'})},y=()=>d.useSyncExternalStore(()=>()=>{},()=>!1,()=>!0),f=e=>{if(!y())return e.children},x=e=>{const{code:n,innerRef:t,...r}=e,s=d.useRef(null),i=d.useRef(!0),o=d.useMemo(()=>({__html:n??""}),[n]);return d.useEffect(()=>{const a=s.current;a&&i.current&&(i.current=!1,A(a))},[]),c.jsx("div",{...r,ref:b(t,s),dangerouslySetInnerHTML:o})},v=e=>{const{code:n,innerRef:t,...r}=e;return c.jsx("div",{...r,ref:t,dangerouslySetInnerHTML:{__html:n??""}})},h=v,I=d.forwardRef((e,n)=>{const{code:t,executeScriptOnCanvas:r,clientOnly:s,children:i,...o}=e,{renderer:a,isSafeMode:R}=d.useContext(L),j=y(),[w]=d.useState(j);return t===void 0||String(t).trim().length===0?c.jsx(H,{innerRef:n,...o}):w?s!==!0?c.jsx(v,{innerRef:n,code:t,...o}):c.jsx(f,{children:c.jsx(x,{innerRef:n,code:t,...o})}):R?c.jsx(f,{children:c.jsx(h,{innerRef:n,code:t,...o})}):a==="canvas"&&r!==!0?c.jsx(f,{children:c.jsx(h,{innerRef:n,code:t,...o})}):c.jsx(f,{children:c.jsx(x,{innerRef:n,code:t,...o},t)})});I.displayName="HtmlEmbed";export{I as A,E as l,S as m};
